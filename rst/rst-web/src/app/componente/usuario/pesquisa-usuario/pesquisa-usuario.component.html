<ng2-toasty></ng2-toasty>
<app-bloqueio></app-bloqueio>
<p class="titulo-pagina">
    {{title}}
</p>

<div class="container-pesquisar container-form">
    <form class="float-label">
        <div class="row">
            <div class="form-group col-md-8">
                <md-input-container [floatPlaceholder]="true">
                    <input mdInput placeholder="{{ 'app_rst_labels_nome' | recurso }}" type="text" name="nome" maxlength="50" [(ngModel)]="filtro.nome" class="form-control" id="nome">
                </md-input-container>
            </div>
            <div class="form-group col-md-4">
                <md-input-container [floatPlaceholder]="true">
                    <input mdInput placeholder="{{ 'app_rst_labels_login_cpf' | recurso }}" [textMask]="{mask: mascaraCpf, guide: false}" type="text" name="cpf" [(ngModel)]="filtro.login" class="form-control" id="cpf">
                </md-input-container>
            </div>
        </div>
        <div class="row">
            <!--Grid Empresa -->
            <div class="form-group col-sm-6 col-md-8">
                <div class="borda-segmento" style="background-color:white">
                    <div id="modalLupa" #modalLupa class="input-group searchlupa">
                        <md-input-container style="border-color:transparent" [floatPlaceholder]="true">
                            <input mdInput placeholder="{{'app_rst_empresa_subtitulo' | recurso}}" disabled type="text" name="empresa" id="modalLupa" [value]="filtro.empresa.razaoSocial ? filtro.empresa.razaoSocial : ''" appFormularioCamposErro>
                        </md-input-container>
                        <app-empresa-modal [isSelecionado]="filtro.empresa.id" (onRemover)="removerEmpresa()" (onAdicionar)="adicionarEmpresa($event)"></app-empresa-modal>
                    </div>
                </div>
            </div>
            <!--Fim Grid Empresa -->
            <!--Grid Departamento -->

            <div class="form-group col-sm-6 col-lg-4">
                <div class="md-container">
                    <md-select placeholder="{{'app_rst_labels_departamento_regional' | recurso}}" name="depRegional" [(ngModel)]="filtro.departamentoRegional.id" id="selectDepRegional ">
                        <md-option value=''>{{'app_rst_labels_selecione' | recurso}}</md-option>
                        <md-option *ngFor='let depart of departamentos' [value]="depart.id">{{depart.razaoSocial}}</md-option>
                    </md-select>
                </div>
            </div>


            <!--Fim Grid Departamento -->
        </div>

        <div class="row">
            <div class="form-group col-sm-6 col-md-6">
                <div class="md-container">
                    <md-select placeholder="{{'app_rst_menu_perfil' | recurso}}" name="perfil" [(ngModel)]="filtro.codigoPerfil" id="selectDepRegional ">
                        <md-option value=''>{{'app_rst_labels_selecione' | recurso}}</md-option>
                        <md-option *ngFor='let perfil of perfis' [value]="perfil.codigo">{{perfil.nome}}</md-option>
                    </md-select>
                </div>
            </div>
        </div>
    </form>
</div>


<div class="btn-filter-pesquisar space-up">
    <button type="button" class="btn btn-primary" (click)="pesquisar();">{{'app_rst_btn_pesquisar' | recurso}}</button>
    <button type="button" class="btn btn-primary" (click)="novo()" *ngIf="hasPermissaoInclusao()">{{'app_rst_btn_novo' | recurso}}</button>
    <button type="button" class="btn btn-primary" (click)="gerarPDF()" >Gerar PDF</button>
    <button type="button" class="btn btn-primary" (click)="gerarCSV()" >Gerar CSV</button>
</div>



<div class="container-form space-up" *ngIf="!isListaVazia()">
    <div class="grid-pesquisa">
        <table class="table table-responsive table-hover">
            <thead>
                <tr>
                    <th class="label">
                        <span class="label">{{ 'app_rst_labels_nome' | recurso }}</span>
                    </th>
                    <th class="label">
                        <span class="label">{{ 'app_rst_labels_login_cpf' | recurso }}</span>
                    </th>
                    <th class="label">
                        <span class="label">{{ 'app_rst_labels_email' | recurso }}</span>
                    </th>
                    <th class="label text-center">
                        <span class="label"></span>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr (click)="selecionar(item)" *ngFor="let item of usuarios">
                    <td class="col-quebra">{{item.nome}}</td>
                    <td class="col-nao-quebra">{{getCpfFormatado(item.login)}}</td>
                    <td class="col-quebra">{{item.email}}</td>
                    <td class="text-center" *ngIf="temPermissaoDesativar()">
                        <button class="btn-link" (click)="$event.stopPropagation(); desativarUsuario(item)">
                                <img class="lixo" src="assets/img/trash.svg" alt="Excluir">
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="btn-paginacao">
            <pagination [firstText]="paginacao.textPrimeiro" [lastText]="paginacao.textUltimo" [nextText]="paginacao.textProximo" [previousText]="paginacao.textAnterior" [totalItems]="paginacao.totalItens" [(ngModel)]="paginacao.pagina" [itemsPerPage]="paginacao.qtdRegistro"
                (numPages)="paginacao.numPages = $event" (pageChanged)="pageChanged($event)" [maxSize]="paginacao.maxSize" class="pagination-sm justify-content-center" [align]="true" [boundaryLinks]="true" [rotate]="false"></pagination>
        </div>
    </div>
</div>
