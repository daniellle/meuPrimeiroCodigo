"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var crypto = require("crypto");
var Element_1 = require("../../../rm/datastructures/Element");
var AESCryptor = /** @class */ (function () {
    function AESCryptor(password) {
        this.password = password;
    }
    AESCryptor.prototype.getType = function () {
        return Element_1.Element;
    };
    AESCryptor.prototype.onDeSerializer = function (json) {
        if (json.value) {
            var decipher = crypto.createDecipher('aes192', this.password);
            var decrypted = decipher.update(json.value, 'base64', 'utf8');
            decrypted += decipher.final('utf8');
            json.value = JSON.parse(decrypted);
        }
        return json;
    };
    AESCryptor.prototype.onSerializer = function (json) {
        if (json.value) {
            var cipher = crypto.createCipher('aes192', this.password);
            var encrypted = cipher.update(JSON.stringify(json.value), 'utf8', 'base64');
            encrypted += cipher.final('base64');
            json.value = encrypted;
        }
        return json;
    };
    return AESCryptor;
}());
exports.AESCryptor = AESCryptor;
//# sourceMappingURL=AESCryptor.js.map